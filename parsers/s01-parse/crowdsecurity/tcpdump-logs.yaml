onsuccess: next_stage
filter: "evt.Event.program == 'tcpdump'"
name: crowdsecurity/tcpdump-logs
#debug: true
description: "Parse tcpdump raw logs"
grok:
  name: "TCPDUMP_OUTPUT"
  apply_on: message
statics:
    - meta: service
      value: tcp
    - meta: log_type
      value: tcp_syn
    - meta: source_ip
      expression: "evt.Event.source_ip"
    - meta: dest_ip
      expression: "evt.Event.dest_ip"
    - meta: dest_port
      expression: "evt.Event.dest_port"
    - parsed: "new_connection"
      expression: "evt.Event.tcpflags contains 'S' ? 'true' : 'false'"